{"version":3,"sources":["users.js"],"names":["express","require","router","Router","passport","catchAsync","User","get","req","res","render","post","next","body","email","username","password","user","register","registeredUser","login","err","flash","redirect","message","authenticate","failureFlash","failureRedirect","logout","module","exports"],"mappings":";;AAAA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AACA,IAAMC,MAAM,GAAGF,OAAO,CAACG,MAAR,EAAf;;AACA,IAAMC,QAAQ,GAAGH,OAAO,CAAC,UAAD,CAAxB;;AACA,IAAMI,UAAU,GAAGJ,OAAO,CAAC,qBAAD,CAA1B;;AACA,IAAMK,IAAI,GAAGL,OAAO,CAAC,gBAAD,CAApB;;AAEAC,MAAM,CAACK,GAAP,CAAW,WAAX,EAAwB,UAACC,GAAD,EAAMC,GAAN,EAAa;AACjCA,EAAAA,GAAG,CAACC,MAAJ,CAAW,UAAX;AACH,CAFD;AAIAR,MAAM,CAACS,IAAP,CAAY,WAAZ,EAAyBN,UAAU,CAAC,iBAAOG,GAAP,EAAYC,GAAZ,EAAiBG,IAAjB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAEIJ,GAAG,CAACK,IAFR,EAEzBC,KAFyB,aAEzBA,KAFyB,EAElBC,QAFkB,aAElBA,QAFkB,EAERC,QAFQ,aAERA,QAFQ;AAG1BC,UAAAA,IAH0B,GAGnB,IAAIX,IAAJ,CAAS;AAACQ,YAAAA,KAAK,EAALA,KAAD;AAAQC,YAAAA,QAAQ,EAARA;AAAR,WAAT,CAHmB;AAAA;AAAA,0CAIHT,IAAI,CAACY,QAAL,CAAcD,IAAd,EAAoBD,QAApB,CAJG;;AAAA;AAI1BG,UAAAA,cAJ0B;AAKhCX,UAAAA,GAAG,CAACY,KAAJ,CAAUD,cAAV,EAA0B,UAAAE,GAAG,EAAI;AAC/B,gBAAIA,GAAJ,EAAS,OAAOT,IAAI,CAAES,GAAF,CAAX;AACTb,YAAAA,GAAG,CAACc,KAAJ,CAAU,SAAV,EAAoB,SAApB;AACAb,YAAAA,GAAG,CAACc,QAAJ,CAAa,OAAb;AAED,WALD;AALgC;AAAA;;AAAA;AAAA;AAAA;AAY9Bf,UAAAA,GAAG,CAACc,KAAJ,CAAW,OAAX,EAAoB,YAAEE,OAAtB;AACAf,UAAAA,GAAG,CAACc,QAAJ,CAAa,WAAb;;AAb8B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAD,CAAnC;AAiBArB,MAAM,CAACK,GAAP,CAAW,QAAX,EAAqB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC/BA,EAAAA,GAAG,CAACC,MAAJ,CAAW,OAAX;AACH,CAFD;AAGAR,MAAM,CAACK,GAAP,CAAW,QAAX,EAAqB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACjCA,EAAAA,GAAG,CAACC,MAAJ,CAAW,OAAX;AACD,CAFD;AAIAR,MAAM,CAACK,GAAP,CAAW,UAAX,EAAuB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACnCA,EAAAA,GAAG,CAACC,MAAJ,CAAW,SAAX;AACD,CAFD;AAIAR,MAAM,CAACS,IAAP,CAAY,QAAZ,EAAsBP,QAAQ,CAACqB,YAAT,CAAsB,OAAtB,EACjB;AAACC,EAAAA,YAAY,EAAE,IAAf;AAAqBC,EAAAA,eAAe,EAAE;AAAtC,CADiB,CAAtB,EAEK,UAACnB,GAAD,EAAMC,GAAN,EAAc;AACXD,EAAAA,GAAG,CAACc,KAAJ,CAAU,SAAV,EAAqB,cAArB;AACAb,EAAAA,GAAG,CAACc,QAAJ,CAAa,OAAb;AACP,CALD;AAOArB,MAAM,CAACK,GAAP,CAAW,SAAX,EAAsB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAChCD,EAAAA,GAAG,CAACoB,MAAJ;AACApB,EAAAA,GAAG,CAACc,KAAJ,CAAU,QAAV,EAAoB,QAApB;AACAb,EAAAA,GAAG,CAACc,QAAJ,CAAa,GAAb;AACH,CAJD;AAMAM,MAAM,CAACC,OAAP,GAAiB5B,MAAjB","sourcesContent":["const express = require('express')\r\nconst router = express.Router()\r\nconst passport = require('passport')\r\nconst catchAsync = require('../utils/catchAsync')\r\nconst User = require('../models/user')\r\n\r\nrouter.get('/register', (req, res) =>{\r\n    res.render('register')\r\n})\r\n\r\nrouter.post('/register', catchAsync(async (req, res, next) =>{\r\n  try {\r\n    const {email, username, password} = req.body\r\n    const user = new User({email, username})\r\n    const registeredUser = await User.register(user, password)\r\n    req.login(registeredUser, err => {\r\n      if (err) return next (err)\r\n      req.flash('success','welcome')\r\n      res.redirect('/user')\r\n  \r\n    })\r\n  } catch (e) {\r\n      req.flash ('error', e.message)\r\n      res.redirect('/register')\r\n  }\r\n}))\r\n\r\nrouter.get('/login', (req, res) => {\r\n    res.render('login')\r\n})\r\nrouter.get('/terms', (req, res) => {\r\n  res.render('terms')\r\n})\r\n\r\nrouter.get('/privacy', (req, res) => {\r\n  res.render('privacy')\r\n})\r\n\r\nrouter.post('/login', passport.authenticate('local',\r\n     {failureFlash: true, failureRedirect: '/login' }),\r\n     (req, res) => {\r\n        req.flash('success', 'welcome back');\r\n        res.redirect('/user')\r\n})\r\n\r\nrouter.get('/logout', (req, res) => {\r\n    req.logout()\r\n    req.flash('succes', 'Goodby')\r\n    res.redirect('/')\r\n})\r\n\r\nmodule.exports = router"],"file":"users.dev.js"}