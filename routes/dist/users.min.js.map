{"version":3,"sources":["users.js"],"names":["express","require","router","Router","catchAsync","passport","req","res","render","User","next","_req$body","email","username","password","user","registeredUser","regeneratorRuntime","async","_context","prev","body","awrap","register","sent","post","err","flash","redirect","t0","message","stop","get","authenticate","failureFlash","failureRedirect","logout","module","exports"],"mappings":"aAAA,IAAMA,QAAUC,QAAQ,WAClBC,OAASF,QAAQG,SADjBH,SAAUC,QAAQ,YAGlBG,WAAaH,QAAQ,uBAFrBC,KAASF,QAAQG,kBACvBD,OAAMG,IAAAA,YAAmB,SAAAC,EAAAC,GAKrBA,EAAIC,OAAO,cAHfN,OAAMO,KAAOR,YAAQG,WAArB,SAAAE,EAAAC,EAAAG,GAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAC,mBAAAC,MAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAT,MAAA,KAAA,EAAA,OAAAS,EAAAC,KAAA,EAAAT,EAE8BJ,EAAOc,KAA1BT,EAFXD,EAEWC,MAAAC,EAFXF,EAEWE,SAAaC,EAFxBH,EAEwBG,SAChBN,EAAO,IAAAC,KAAX,CAAAG,MAAAA,EAAAC,SAAAA,IAHJM,EAAAT,KAAA,EAAAO,mBAAAK,MAEAb,KAAAc,SAAAR,EAAAD,IAFA,KAAA,EAEAE,EAFAG,EAAAK,KAMAtB,EAAOuB,MAAKT,EAAaZ,SAAAA,GAAW,GAAAsB,EAAA,OAAAhB,EAAAgB,GAO9BpB,EAAIqB,MAAM,UAAU,WAPUpB,EAAAqB,SAAA,WANpCT,EAAAT,KAAA,GAAA,MAAA,KAAA,EAAAS,EAAAC,KAAA,EAAAD,EAAAU,GAAAV,EAAA,MAAA,GAMoCb,EAAAqB,MAAA,QAAAR,EAAAU,GAAAC,SAAAvB,EAAAqB,SAAA,aANpC,KAAA,GAAA,IAAA,MAAA,OAAAT,EAAAY,SAAA,KAAA,KAAA,CAAA,CAAA,EAAA,QAS0B7B,OAAA8B,IAAT,SAHmB,SAAA1B,EAAAC,GAAAA,EAAAC,OAAA,WAoBpCN,OAAO8B,IAAI,SAAU,SAAC1B,EAAKC,GApBSA,EAAAC,OAAA,WAM9BN,OAAA8B,IAAA,WAAS,SAAA1B,EAAOI,GAChBJ,EAAAA,OAAAA,aAP8BJ,OAAAuB,KAAA,SAAApB,SAAA4B,aAAA,QAAA,CAAAC,cAAA,EAAAC,gBAAA,WA8B/B,SAAC7B,EAAKC,GA9ByBD,EAAAqB,MAAA,UAAA,gBAAApB,EAAAqB,SAAA,WAa9BrB,OAAAA,IAAAA,UAAA,SAAaD,EAAAC,GAuBfD,EAAI8B,SApC4B9B,EAAAqB,MAAA,SAAA,UAAApB,EAAAqB,SAAA,OAAAS,OAAAC,QAAApC","file":"users.min.js","sourcesContent":["const express = require('express')\r\nconst router = express.Router()\r\nconst passport = require('passport')\r\nconst catchAsync = require('../utils/catchAsync')\r\nconst User = require('../models/user')\r\n\r\nrouter.get('/register', (req, res) =>{\r\n    res.render('register')\r\n})\r\n\r\nrouter.post('/register', catchAsync(async (req, res, next) =>{\r\n  try {\r\n    const {email, username, password} = req.body\r\n    const user = new User({email, username})\r\n    const registeredUser = await User.register(user, password)\r\n    req.login(registeredUser, err => {\r\n      if (err) return next (err)\r\n      req.flash('success','welcome')\r\n      res.redirect('/user')\r\n  \r\n    })\r\n  } catch (e) {\r\n      req.flash ('error', e.message)\r\n      res.redirect('/register')\r\n  }\r\n}))\r\n\r\nrouter.get('/login', (req, res) => {\r\n    res.render('login')\r\n})\r\nrouter.get('/terms', (req, res) => {\r\n  res.render('terms')\r\n})\r\n\r\nrouter.get('/privacy', (req, res) => {\r\n  res.render('privacy')\r\n})\r\n\r\nrouter.post('/login', passport.authenticate('local',\r\n     {failureFlash: true, failureRedirect: '/login' }),\r\n     (req, res) => {\r\n        req.flash('success', 'welcome back');\r\n        res.redirect('/user')\r\n})\r\n\r\nrouter.get('/logout', (req, res) => {\r\n    req.logout()\r\n    req.flash('succes', 'Goodby')\r\n    res.redirect('/')\r\n})\r\n\r\nmodule.exports = router"]}