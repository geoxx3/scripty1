"use strict";var express=require("express"),router=express.Router(),passport=require("passport"),catchAsync=require("../utils/catchAsync"),User=require("../models/user");router.get("/register",function(e,r){r.render("register")}),router.post("/register",catchAsync(function(r,t,s){var n,o,u,c,i,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=r.body,o=n.email,u=n.username,c=n.password,i=new User({email:o,username:u}),e.next=5,regeneratorRuntime.awrap(User.register(i,c));case 5:a=e.sent,r.login(a,function(e){if(e)return s(e);r.flash("success","welcome"),t.redirect("/user")}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),r.flash("error",e.t0.message),t.redirect("/register");case 13:case"end":return e.stop()}},null,null,[[0,9]])})),router.get("/login",function(e,r){r.render("login")}),router.get("/terms",function(e,r){r.render("terms")}),router.get("/privacy",function(e,r){r.render("privacy")}),router.post("/login",passport.authenticate("local",{failureFlash:!0,failureRedirect:"/login"}),function(e,r){e.flash("success","welcome back"),r.redirect("/user")}),router.get("/logout",function(e,r){e.logout(),e.flash("succes","Goodby"),r.redirect("/")}),module.exports=router;
//# sourceMappingURL=users.min.js.map
